<UserControl
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:content="clr-namespace:ManaxClient.ViewModels.Popup.ConfirmCancel.Content"
    xmlns:tag="clr-namespace:ManaxLibrary.DTO.Tag;assembly=ManaxLibrary"
    xmlns:converters="clr-namespace:ManaxClient.Converters"
    mc:Ignorable="d" d:DesignWidth="500" d:DesignHeight="500"
    x:Class="ManaxClient.Views.Popup.ConfirmCancel.Content.SerieUpdateView"
    x:DataType="content:SerieUpdateViewModel"
    Name="Popup">
    
    <UserControl.Resources>
        <converters:ColorToSolidBrushConverter x:Key="ColorToBrushConverter"/>
    </UserControl.Resources>
    
    <Grid Name="MainGrid"
          RowDefinitions="Auto,Auto,Auto,Auto,Auto,Auto" 
          ColumnDefinitions="*" RowSpacing="16" Margin="16">
        <StackPanel Grid.Row="0" 
                    Orientation="Horizontal" 
                    Spacing="12" 
                    Margin="0,0,0,8">
            <TextBlock Text="ðŸ“–" 
                       FontSize="24" 
                       VerticalAlignment="Center" />
            <StackPanel Spacing="4">
                <TextBlock
                    Text="Mettre Ã  jour la sÃ©rie"
                    FontSize="18"
                    FontWeight="Bold"
                    Foreground="#212529" />
                <TextBlock
                    Text="Modifiez les informations de la sÃ©rie"
                    FontSize="12"
                    Foreground="#6C757D" />
            </StackPanel>
        </StackPanel>

        <StackPanel Grid.Row="1" Spacing="8">
            <TextBlock
                Text="Titre"
                FontWeight="Medium"
                Foreground="#495057" />
            <TextBox
                Text="{Binding Title}"
                Watermark="Entrez le titre de la sÃ©rie..."
                Padding="12"
                CornerRadius="8"
                BorderThickness="1"
                BorderBrush="#DEE2E6"
                FontSize="14">
                <TextBox.Styles>
                    <Style Selector="TextBox:pointerover">
                        <Setter Property="BorderBrush" Value="#007ACC" />
                    </Style>
                    <Style Selector="TextBox:focus">
                        <Setter Property="BorderBrush" Value="#007ACC" />
                    </Style>
                </TextBox.Styles>
            </TextBox>
        </StackPanel>

        <StackPanel Grid.Row="2" Spacing="8">
            <TextBlock
                Text="Description"
                FontWeight="Medium"
                Foreground="#495057" />
            <TextBox
                Text="{Binding Description}"
                Watermark="Entrez la description de la sÃ©rie..."
                AcceptsReturn="True"
                TextWrapping="Wrap"
                Height="80"
                Padding="12"
                CornerRadius="8"
                BorderThickness="1"
                BorderBrush="#DEE2E6"
                FontSize="14">
                <TextBox.Styles>
                    <Style Selector="TextBox:pointerover">
                        <Setter Property="BorderBrush" Value="#007ACC" />
                    </Style>
                    <Style Selector="TextBox:focus">
                        <Setter Property="BorderBrush" Value="#007ACC" />
                    </Style>
                </TextBox.Styles>
            </TextBox>
        </StackPanel>

        <StackPanel Grid.Row="3" Orientation="Horizontal" Spacing="16">
            <StackPanel Spacing="8" HorizontalAlignment="Left" Width="240">
                <TextBlock
                    Text="Statut"
                    FontWeight="Medium"
                    Foreground="#495057" />
                <ComboBox
                    ItemsSource="{Binding StatusOptions}"
                    SelectedItem="{Binding SelectedStatus}"
                    HorizontalAlignment="Stretch"
                    Padding="12"
                    CornerRadius="8"
                    BorderThickness="1"
                    BorderBrush="#DEE2E6">
                    <ComboBox.Styles>
                        <Style Selector="ComboBox:pointerover">
                            <Setter Property="BorderBrush" Value="#007ACC" />
                        </Style>
                        <Style Selector="ComboBox:focus">
                            <Setter Property="BorderBrush" Value="#007ACC" />
                        </Style>
                    </ComboBox.Styles>
                </ComboBox>
            </StackPanel>

            <StackPanel Spacing="8" HorizontalAlignment="Left" Width="240">
                <TextBlock
                    Text="BibliothÃ¨que"
                    FontWeight="Medium"
                    Foreground="#495057" />
                <ComboBox
                    ItemsSource="{Binding Libraries}"
                    SelectedItem="{Binding SelectedLibrary}"
                    HorizontalAlignment="Stretch"
                    Padding="12"
                    CornerRadius="8"
                    BorderThickness="1"
                    BorderBrush="#DEE2E6">
                    <ComboBox.Styles>
                        <Style Selector="ComboBox:pointerover">
                            <Setter Property="BorderBrush" Value="#007ACC" />
                        </Style>
                        <Style Selector="ComboBox:focus">
                            <Setter Property="BorderBrush" Value="#007ACC" />
                        </Style>
                    </ComboBox.Styles>
                    <ComboBox.ItemTemplate>
                        <DataTemplate>
                            <TextBlock Text="{Binding Name}" />
                        </DataTemplate>
                    </ComboBox.ItemTemplate>
                </ComboBox>
            </StackPanel>
        </StackPanel>

        <StackPanel Grid.Row="4" Spacing="8">
            <TextBlock
                Text="Tags"
                FontWeight="Medium"
                Foreground="#495057"
                VerticalAlignment="Center" />
            <ComboBox
                Width="200"
                ItemsSource="{Binding AvailableTags}"
                SelectedItem="{Binding SelectedTag, Mode=TwoWay}"
                PlaceholderText="SÃ©lectionner un tag..."
                Padding="8"
                CornerRadius="6"
                BorderThickness="1"
                BorderBrush="#DEE2E6"
                FontSize="12">
                <ComboBox.ItemTemplate>
                    <DataTemplate DataType="tag:TagDto">
                        <TextBlock Text="{Binding Name}" />
                    </DataTemplate>
                </ComboBox.ItemTemplate>
                <ComboBox.Styles>
                    <Style Selector="ComboBox:pointerover">
                        <Setter Property="BorderBrush" Value="#007ACC" />
                    </Style>
                    <Style Selector="ComboBox:focus">
                        <Setter Property="BorderBrush" Value="#007ACC" />
                    </Style>
                </ComboBox.Styles>
            </ComboBox>
        </StackPanel>
        
        <Border Grid.Row="5"
                BorderBrush="#DEE2E6"
                BorderThickness="1"
                CornerRadius="8"
                Padding="8"
                MinHeight="60">
                 <ItemsControl ItemsSource="{Binding SelectedTags}"
                              HorizontalAlignment="Stretch">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <WrapPanel Orientation="Horizontal" MaxWidth="460" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border
                                Background="#E7F3FF"
                                BorderBrush="{Binding Color, Converter={StaticResource ColorToBrushConverter}}"
                                BorderThickness="2"
                                CornerRadius="16"
                                Margin="2"
                                Padding="8,4">
                                <StackPanel Orientation="Horizontal" Spacing="4">
                                    <TextBlock
                                        Text="{Binding Name}"
                                        FontSize="12"
                                        VerticalAlignment="Center"/>
                                    <Button
                                        Content="âœ•"
                                        VerticalContentAlignment="Center"
                                        HorizontalContentAlignment="Center"
                                        FontSize="10"
                                        Width="16"
                                        Height="16"
                                        Padding="0"
                                        Background="Transparent"
                                        BorderThickness="0"
                                        Foreground="#007ACC"
                                        Command="{Binding $parent[UserControl].((content:SerieUpdateViewModel)DataContext).RemoveTag}"
                                        CommandParameter="{Binding}">
                                        <Button.Styles>
                                            <Style Selector="Button:pointerover">
                                                <Setter Property="Foreground" Value="Red" />
                                            </Style>
                                        </Button.Styles>
                                    </Button>
                                </StackPanel>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </Border>
            <TextBlock
                Grid.Row="5"
                Text="Aucun tag sÃ©lectionnÃ©"
                FontSize="12"
                Foreground="#6C757D"
                HorizontalAlignment="Center"
                Margin="0,8,0,0"
                IsVisible="{Binding !SelectedTags.Count}" />
    </Grid>
</UserControl>